## 四、模型训练

### 4.1 数据调整

* images：存放图片
  * train：训练集图片
  * val：验证集图片
* labels：存放标签
  * train：训练集标签文件，要与训练集图片名称一一对应
  * val：验证集标签文件，要与验证集图片一一对应

### 4.2 关键参数

* weights：预训练的权重文件
* data：数据集描述文件

### 4.3训练步骤：

* 将之前整理好的数据集文件【datasets】移入自己创建的【yolov5-7.0】虚拟环境文件夹内：

  * ![image](https://github.com/CoderSuHang/TensorRT-Learning-Note/assets/104765251/83654fc4-06a3-4629-a9d2-72fc383238c3)


* 将【coco128.yaml】文件复制创建自己的【gesture.yaml】文件，并修改类名称和相关路径地址：

  * ![image](https://github.com/CoderSuHang/TensorRT-Learning-Note/assets/104765251/f3e1a4cd-044e-4056-804b-a68694571453)


* 修改【train.py】中的--data参数文件夹名：

  * ![image](https://github.com/CoderSuHang/TensorRT-Learning-Note/assets/104765251/0c585095-934a-4714-96f1-789062e0ce4a)


* 运行训练：

  * ![image-20240229115625626](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240229115625626.png)

* 出现问题：

  * 未安装git：
    * ![image-20240229120010865](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240229120010865.png)
    * 原因：未安装git，安装以后即可解决。

  * 页面文件太小，无法完成操作：
    * ![image-20240304105628117](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304105628117.png)
    * 解决办法：
      * 调整训练参数中的workers，设置为1
        * ![image-20240304105751386](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304105751386.png)

      * 修改虚拟内存，将环境安装位置所在的盘，设置一个较大的参数
        * ![image-20240304105936157](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304105936157.png)
        * ![image-20240304110103390](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304110103390.png)
      * pytorch版本过高，未出现，见up主视频11.00处有解决办法：
        * ![image-20240304110459608](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304110459608.png)

* 训练完成：

  * ![image-20240304110605346](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304110605346.png)

  * ![image-20240304110703994](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304110703994.png)

    * 调用TensorBoard可以查看训练数据：

      * 指令：

        * ```python
          (yolov5) E:\AI\Package\yolov5-7.0>tensorboard --logdir runs
          ```

      * ![image-20240304112357100](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304112357100.png)

      * ![image-20240304112505833](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304112505833.png)

      * ![image-20240304112555567](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304112555567.png)

* 验证训练结果：

  * 指令：

    * ```python
      (yolov5) E:\AI\Package\yolov5-7.0>python detect.py --weights runs/train/exp9/weights/best.pt --source datasets/gesture.mp4 --view-img
      ```

    * ![image-20240304112817685](C:\Users\10482\AppData\Roaming\Typora\typora-user-images\image-20240304112817685.png)
